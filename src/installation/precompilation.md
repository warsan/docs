# Предварительная компиляция шаблонов

Используя прекомпилятор Handlebars, вы можете предварительно скомпилировать шаблоны Handlebars, чтобы сэкономить время на клиенте и уменьшить
требуемый размер библиотеки handlebars во время выполнения.

## Приступая к работе

Во-первых, вам понадобятся _Node.js и npm_. Перейдите на [https://nodejs.org/ru/download/](https://nodejs.org/ru/download/)
чтобы узнать, как это сделать в вашей ОС.

Затем установите пакет Handlebars npm, содержащий прекомпилятор.

```bash
npm install -g handlebars
```

Создайте файл с именем `example.handlebars`, содержащий ваш шаблон:

<<< @/src/usage-examples/precompilation/example.handlebars

Запускаем прекомпилятор.

```bash
handlebars example.handlebars -f example.precompiled.js
```

Включите среду выполнения Handlebars и предварительно скомпилированный javascript.

<<< @/src/usage-examples/precompilation/index.html

Среда выполнения также доступна для загрузки на [странице установки](index.md#download-handlebars).

## Оптимизация

Поскольку вы предварительно компилируете шаблоны, вы также можете применить несколько оптимизаций к компилятору. Первый позволяет
указать список известных помощников компилятору

```bash
handlebars <input> -f <output> -k each -k if -k unless
```

Компилятор Handlebars оптимизирует доступ к этим помощникам для повышения производительности. Когда все помощники известны при компиляции
время, опция `--knownOnly` предоставляет наименьший сгенерированный код, который также обеспечивает самое быстрое выполнение.

## Использование

!HANDLEBARS_HELP!

При использовании обычного режима прекомпилятора полученные шаблоны будут сохранены в объекте Handlebars.templates с использованием относительного имени шаблона без расширения.  
Эти шаблоны могут выполняться так же, как и шаблоны. При использовании
в простом режиме прекомпилятор сгенерирует единственный метод javascript.  
Для выполнения этого метода его необходимо передать в метод Handlebars.template и полученный объект можно использовать как обычно.

## Предварительная компиляция шаблонов внутри NodeJS

Если вы хотите предварительно скомпилировать шаблоны изнутри NodeJS--без вызова «handlebars» из командной строки--это можно
сделать с помощью Handlebars.precompile. Передайте строковый результат этой функции своим клиентам, и они, в свою очередь, смогут проанализировать
это с Handlebars.template.

<<< @/src/usage-examples/precompilation/precompile-in-nodejs.js

Результат будет следующим:

<<< @/src/usage-examples/precompilation/precompile-in-nodejs.output.js

На стороне клиента у вас есть Javascript следующего вида.

```js
Handlebars.partials["test1"] = Handlebars.template({
  /** insert compiled output here **/
});
```

Наконец, вы можете динамически ссылаться на эти шаблоны в своем Javascript.

```js
var result = Handlebars.partials["test1"]({ name: "yourname" });
// делай что хочешь с результатом
```

## Интеграции

Некоторые пакеты npm могут использоваться для интеграции прекомпилятора Handlebars в вашу систему сборки. (i.e. Webpack,
Browserify...). Взгляните на страницу интеграции:

!button[Learn more: Integrations](integrations.md)
